<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Designação de Fiscal de Contrato - Formulário</title>
    <style>
        /* Estilos básicos para o formulário */
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        
        /* Estilo do título do formulário */
        h2 { color: #333; border-bottom: 3px solid #ddd; padding-bottom: 3px; margin-top: 20px; text-align: center; line-height: 1.2; }
        .subtitulo { display: block; font-size: 0.8em; font-weight: normal; margin-top: 6px; }
       
       .container h2:first-of-type { 
            overflow: hidden; 
            padding-left: 100px; 
            box-sizing: border-box; 
            /* AUMENTAR ESTE VALOR PARA CRIAR MAIS ESPAÇO ABAIXO DO TÍTULO PRINCIPAL */
            margin-bottom: 40px; /* Altere 40px (ou o valor atual) para, por exemplo, 60px */
        }
       
       
        h3 { color: #333; border-bottom: 2px solid #ddd; padding-bottom: 2px; margin-top: 10px; }
        
        /* Estilo do logo no formulário */
        .logo-formulario { float: left; margin-right: 10px; }
        .logo-formulario img { max-height: 80px; width: auto; }
        .container h2:first-of-type { overflow: hidden; padding-left: 100px; box-sizing: border-box; } /* Limpa o float e ajusta o padding */
        
        label { display: block; margin-top: 10px; font-weight: bold; }
        
        /* Estilos para inputs, selects e textareas */
        input[type="text"], input[type="number"], input[type="date"], textarea, select {
            width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;
            transition: background-color 0.2s ease; 
        }
        textarea { resize: vertical; height: 100px; }
        
        /* Destaque de campo preenchido */
        .filled { background-color: #e6f7ff !important; border-color: #a3e6a3 !important; }

        /* Foco: Mudar para branco ao focar */
        input:focus, textarea:focus, select:focus {
            background-color: #ffffff; 
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); 
        }

        button { background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px; font-size: 16px; margin-right: 10px;}
        button:hover { background-color: #0056b3; }
        .grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        .full-width { grid-column: 1 / -1; }

        /* Estilos do Memorando de Saída */
        #memorando-output {
            display: none; /* Controlado pelo JS */
            padding: 30px; margin-top: 10px; line-height: 1.5;
        }
        #memorando-output p { font-size: 10pt; text-align: justify; margin-bottom: 1em; }
        
        /* NOVO ESTILO DO CABEÇALHO (Baseado no PGM) */
        .memorando-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 3px solid #ccc; padding-bottom: 10px; margin-bottom: 30px;
        }
        .header-unidade {
            font-size: 20px; font-weight: bold; color: #000; line-height: 1.2;
            padding-right: 20px; border-right: 1px solid #333; flex-grow: 1; 
        }
        .header-unidade span { display: block; font-weight: normal; font-size: 24px; } 
        #out-prefeitura-fixa { display: block; font-size: 12px; font-weight: normal; color: #555; margin-top: 5px; } 
        .header-logo { padding-left: 16px; text-align: right; } 
        .header-logo img { max-height: 100px; width: auto; display: block; }

        /* AJUSTES DE TAMANHO DE FONTE DO MEMORANDO */
        #memorando-output h1 { font-size: 12pt; text-align: center; margin-bottom: 30px; }
        #memorando-output .assinatura { margin-top: 80px; text-align: center; font-size: 10pt; }
        #memorando-output .data-local { text-align: right; margin-top: 40px; font-size: 10pt; }
        #memorando-output .linha-assinatura { border-top: 1px solid #000; width: 60%; margin: 5px auto 0; }
        
        /* Ocultar formulário na impressão e exibir memorando */
        @media print {
            #formulario, #botoes-acao, #btn-editar, #btn-imprimir { display: none; }
            #memorando-output { display: block !important; border: none; padding: 0; }
            body { margin: 0; padding: 0; background: white; }
            .container { box-shadow: none; padding: 0; }
            .memorando-header {
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact; 
            }
        }
    </style>
</head>
<body>

<div class="container">

    <div id="formulario">
        <div class="logo-formulario">
            <img src="https://danilobrand-adv.github.io/contratos/LOGO_PMG_2025.png" alt="Logo do Município de Goiana">
        </div>
        <h2>
            COORDENADORIA DO SISTEMA DE CONTROLE INTERNO
            <span class="subtitulo">Formulário de Designação de Fiscal de Contratatação</span>
        </h2>
        
        <h3>0. Identificação da Unidade Emissora</h3>
        <div class="full-width">
            <label for="unidadeSelect">Unidade Emissora do Documento (Cabeçalho):</label>
            <select id="unidadeSelect" onchange="selecionarUnidade()">
                <option value="" selected>--- Selecione a Unidade ---</option>
                <option value="AD GOIANA">AD GOIANA</option>
                <option value="ADMINISTRAÇÃO E GESTÃO DE QUALIDADE">ADMINISTRAÇÃO E GESTÃO DE QUALIDADE</option>
                <option value="AGRICULTURA, PESCA E MEIO AMBIENTE">AGRICULTURA, PESCA E MEIO AMBIENTE</option>
                <option value="AUTARQUIA MUNICIPAL DO ENSINO SUPERIOR DE GOIANA DR. CLOVIS FONTENELLE">AUTARQUIA MUNICIPAL DO ENSINO SUPERIOR DE GOIANA DR. CLOVIS FONTENELLE</option>
                <option value="COMUNICAÇÃO">COMUNICAÇÃO</option>
                <option value="COMISSÃO PERMANENTE DE LICITAÇÃO">COMISSÃO PERMANENTE DE LICITAÇÃO</option>
                <option value="CONTROLADORIA">CONTROLADORIA</option>
                <option value="AGÊNCIA MUNICIPAL DE MEIO AMBIENTE DE GOIANA">AGÊNCIA MUNICIPAL DE MEIO AMBIENTE DE GOIANA</option>
                <option value="DESENVOLVIMENTO ECONÔMICO E TECNOLOGIA">DESENVOLVIMENTO ECONÔMICO E TECNOLOGIA</option>
                <option value="EDUCAÇÃO E INOVAÇÃO">EDUCAÇÃO E INOVAÇÃO</option>
                <option value="ARRECADAÇÃO E FINANÇAS">ARRECADAÇÃO E FINANÇAS</option>
                <option value="ARTICULAÇÃO POLÍTICA E GOVERNO">ARTICULAÇÃO POLÍTICA E GOVERNO</option>
                <option value="GABINETE DO PREFEITO">GABINETE DO PREFEITO</option>
                <option value="GOIANAPREVI">GOIANAPREVI</option>
                <option value="MULHER">MULHER</option>
                <option value="POLÍTICAS SOCIAIS">POLÍTICAS SOCIAIS</option>
                <option value="PLANEJAMENTO ESTRATÉGICO">PLANEJAMENTO ESTRATÉGICO</option>
                <option value="PROCURADORIA GERAL DO MUNICÍPIO">PROCURADORIA GERAL DO MUNICÍPIO</option>
                <option value="OUVIDORIA">OUVIDORIA</option>
                <option value="SAÚDE">SAÚDE</option>
                <option value="GABINETE DO VICE-PREFEITO">GABINETE DO VICE-PREFEITO</option>
                <option value="ESPORTE E JUVENTUDE">ESPORTE E JUVENTUDE</option>
                <option value="SEGURANÇA CIDADÃ E TRÂNSITO">SEGURANÇA CIDADÃ E TRÂNSITO</option>
                <option value="MANUTENÇÃO E SERVIÇOS PÚBLICOS">MANUTENÇÃO E SERVIÇOS PÚBLICOS</option>
                <option value="TURISMO E DESENVOLVIMENTO CULTURAL">TURISMO E DESENVOLVIMENTO CULTURAL</option>
                <option value="URBANISMO OBRAS E PATRIMÔNIO">URBANISMO OBRAS E PATRIMÔNIO</option>
            </select>

            <input type="text" id="unidadeEmissora" value="" required style="margin-top: 10px;">
            <p class="hint">Ex: Procuradoria Geral do Município, Secretaria de Educação, etc.</p>
        </div>

        <h3>1. Dados do Contrato e Data</h3>
        <div class="grid">
            <div>
                <label for="exercicio">Exercício:</label>
                <input type="number" id="exercicio" value="2025" required>
            </div>
            <div>
                <label for="dataMemorando">Data do Memorando:</label>
                <input type="date" id="dataMemorando" value="" required>
            </div>
            <div class="full-width">
                <label for="setorAtendido">Setor a ser Atendido/Destino (Corpo do Memorando):</label>
                <input type="text" id="setorAtendido" value="" required>
            </div>
           <div class="full-width">
                <label for="objetoSelect">Selecionar Objeto Predefinido:</label>
                <select id="objetoSelect" onchange="selecionarObjeto()">
                    <option value="" selected>--- Selecione ou Escreva Abaixo ---</option>
                    <option value="Serviço de Limpeza Urbana e Coleta de Resíduos">Serviço de Limpeza Urbana e Coleta de Resíduos</option>
                    <option value="Aquisição de Material de Consumo para Escritório">Aquisição de Material de Consumo para Escritório</option>
                    <option value="CONTRATAÇÃO DE EMPRESA PARA O FORNECIMENTO DE ÁGUA MINERAL">Contratação de Água Mineral (Completo)</option>
                </select>
            </div>

            <div class="full-width" style="margin-top: 15px;">
                <label for="objetoContrato">Detalhes / Edição do Objeto:</label>
                <textarea id="objetoContrato" required></textarea>
            </div>
        </div>

        <h3>2. Fiscal de Contrato (Titular)</h3>
        <div class="grid">
            <div class="full-width">
                <label for="nomeFiscal">Nome Completo:</label>
                <input type="text" id="nomeFiscal" value="" required>
            </div>
            <div><label for="rgFiscal">RG:</label><input type="text" id="rgFiscal" value="" required></div>
            <div><label for="cpfFiscal">CPF:</label><input type="text" id="cpfFiscal" value="" required></div>
            <div><label for="matriculaFiscal">Matrícula/Portaria:</label><input type="text" id="matriculaFiscal" value="" required></div>
            <div class="full-width">
                <label for="lotacaoFiscal">Lotação (Setor atual):</label>
                <input type="text" id="lotacaoFiscal" value="" required>
            </div>
        </div>
        
        <h3>3. Fiscal de Contrato (Suplente)</h3>
        <div class="grid">
            <div class="full-width">
                <label for="nomeSuplente">Nome Completo:</label>
                <input type="text" id="nomeSuplente" value="" required>
            </div>
            <div><label for="rgSuplente">RG:</label><input type="text" id="rgSuplente" value="" required></div>
            <div><label for="cpfSuplente">CPF:</label><input type="text" id="cpfSuplente" value="" required></div>
            <div><label for="matriculaSuplente">Matrícula/Portaria:</label><input type="text" id="matriculaSuplente" value="" required></div>
        </div>

        <h3>4. Autoridade Designante</h3>
        <div class="grid">
            <div>
                <label for="nomeDesignante">Nome Completo:</label>
                <input type="text" id="nomeDesignante" value="" required>
            </div>
            <div>
                <label for="cargoDesignante">Cargo/Função:</label>
                <input type="text" id="cargoDesignante" value="" required>
            </div>
        </div>
        
        <div id="botoes-acao">
            <button type="button" onclick="gerarMemorando()">Gerar Memorando / Visualizar</button>
        </div>
    </div> 
    
    <div id="memorando-output">
        <div class="memorando-header">
            <div class="header-unidade">
                <span id="out-unidadeEmissora1"></span>
                <span id="out-unidadeEmissora2"></span>
                <span id="out-prefeitura-fixa">PREFEITURA MUNICIPAL DE GOIANA</span>
            </div>
            <div class="header-logo">
                <img id="logoGoiana" src="https://danilobrand-adv.github.io/contratos/LOGO_PMG_2025.png" alt="Logo do Município de Goiana">
            </div>
        </div>
        <h1>MEMORANDO – DESIGNAÇÃO DE FISCAL DE CONTRATAÇÃO</h1>

        <p>Fica designado, o servidor <span id="out-nomeFiscal" style="font-weight: bold;"></span>, RG nº <span id="out-rgFiscal"></span>, CPF nº <span id="out-cpfFiscal"></span> e Matrícula nº <span id="out-matriculaFiscal"></span>, lotado na <span id="out-lotacaoFiscal"></span>, como Fiscal de Contratação referente à <span id="out-objetoContrato" style="font-weight: bold;"></span>, para atender às necessidades da <span id="out-setorAtendido"></span> para o exercício de <span id="out-exercicio" style="font-weight: bold;"></span>, atendendo às exigências contidas no do art. nº 7 e do artigo nº 117 da Lei nº 14.133 de 2021.</p>

        <p>Na ausência do servidor supra designado, fica designada como suplente a Servidora <span id="out-nomeSuplente" style="font-weight: bold;"></span>, RG nº <span id="out-rgSuplente"></span>, CPF nº <span id="out-cpfSuplente"></span> e Matrícula nº <span id="out-matriculaSuplente"></span>.</p>

        <div class="assinatura" style="margin-top: 50px;">
            <div class="linha-assinatura"></div>
            <span id="out-nomeDesignante" style="font-weight: bold;"></span><br>
            <span id="out-cargoDesignante"></span>
        </div>

        <h3 style="margin-top: 40px; font-size: 12px; border-bottom: none;">CIÊNCIA DO SERVIDOR DESIGNADO PARA FISCAL</h3> 
        <p>Eu, <span id="out-ciencia-fiscal" style="font-weight: bold;"></span>, declaro-me ciente da designação de fiscal de contrato ora atribuída, e das suas funções que são inerentes em razão da função.</p>
        
        <h3 style="margin-top: 20px; font-size: 12px; border-bottom: none;">CIÊNCIA DO SERVIDOR DESIGNADO PARA SUPLENTE</h3>
        <p>Eu, <span id="out-ciencia-suplente" style="font-weight: bold;"></span>, declaro-me ciente da designação de suplente de fiscal de contrato ora atribuída, e das suas funções que são inerentes em razão da função.</p>

        <div class="data-local">
            Goiana, <span id="out-dataExtenso"></span>.
        </div>
        
        <div style="margin-top: 20px;">
            <div class="assinatura">
                <div class="linha-assinatura"></div>
                <span id="out-assinatura-fiscal" style="font-weight: bold;"></span><br>
                Fiscal do contrato indicado
            </div>
            
            <div class="assinatura" style="margin-top: 40px;">
                <div class="linha-assinatura"></div>
                <span id="out-assinatura-suplente" style="font-weight: bold;"></span><br>
                Suplente do Fiscal do contrato
            </div>
        </div>

        <div id="botoes-memorando" style="text-align: center; margin-top: 40px;">
            <button type="button" onclick="voltarParaEdicao()" id="btn-editar">Voltar e Editar</button>
            <button type="button" onclick="window.print()" id="btn-imprimir">Imprimir (ou Salvar como PDF)</button>
        </div>
        
    </div> 
</div>

<script>
    // [FUNÇÕES AUXILIARES]
    function formatarData(dataString) {
        if (!dataString) return '';
        const [ano, mes, dia] = dataString.split('-');
        const meses = [
            'janeiro', 'fevereiro', 'março', 'abril', 'maio', 'junho',
            'julho', 'agosto', 'setembro', 'outubro', 'novembro', 'dezembro'
        ];
        return `${dia} de ${meses[parseInt(mes) - 1]} de ${ano}`;
    }

    function dividirUnidade(texto) {
        const partes = texto.split(/ (Geral do Município|Municipal|de Contrato)/i);
        if (partes.length > 1) {
            const linha1 = partes[0].trim() + (partes[1] ? ' ' + partes[1].trim() : ''); 
            const linha2 = partes.slice(2).join(' ').trim();
            return [linha1, linha2 || ''];
        }
        return [texto, ''];
    }

    // [FUNÇÃO DE MONITORAMENTO DE CAMPOS]
    function aplicarEstiloPreenchido() {
        const campos = document.querySelectorAll('input, textarea, select');
        
        campos.forEach(campo => {
            if (campo.value && campo.value.trim() !== "") {
                campo.classList.add('filled');
            } else {
                campo.classList.remove('filled');
            }
        });
    }

    // [FUNÇÕES DE SELEÇÃO]
    function selecionarObjeto() {
        const select = document.getElementById('objetoSelect');
        const textarea = document.getElementById('objetoContrato');
        
        if (select.value !== "") {
            textarea.value = select.value;
        } else {
            textarea.value = "";
            textarea.focus();
        }
        aplicarEstiloPreenchido();
    }
    
    function selecionarUnidade() {
        const select = document.getElementById('unidadeSelect');
        const input = document.getElementById('unidadeEmissora');
        
        if (select.value !== "") {
            input.value = select.value;
        } else {
            input.value = "";
            input.focus();
        }
        aplicarEstiloPreenchido();
    }

    // [FUNÇÃO PRINCIPAL: GERAR MEMORANDO]
    function gerarMemorando() {
        
        const camposObrigatorios = [
            { id: 'unidadeEmissora', nome: 'Unidade Emissora' },
            { id: 'exercicio', nome: 'Exercício' },
            { id: 'dataMemorando', nome: 'Data do Memorando' },
            { id: 'setorAtendido', nome: 'Setor a ser Atendido/Destino' },
            { id: 'objetoContrato', nome: 'Objeto do Contrato' },
            { id: 'nomeFiscal', nome: 'Nome Fiscal (Titular)' },
            { id: 'rgFiscal', nome: 'RG Fiscal (Titular)' },
            { id: 'cpfFiscal', nome: 'CPF Fiscal (Titular)' },
            { id: 'matriculaFiscal', nome: 'Matrícula/Portaria Fiscal (Titular)' },
            { id: 'lotacaoFiscal', nome: 'Lotação Fiscal (Titular)' },
            { id: 'nomeSuplente', nome: 'Nome Fiscal (Suplente)' },
            { id: 'rgSuplente', nome: 'RG Fiscal (Suplente)' },
            { id: 'cpfSuplente', nome: 'CPF Fiscal (Suplente)' },
            { id: 'matriculaSuplente', nome: 'Matrícula/Portaria Fiscal (Suplente)' },
            { id: 'nomeDesignante', nome: 'Nome da Autoridade Designante' },
            { id: 'cargoDesignante', nome: 'Cargo/Função da Autoridade Designante' }
        ];

        let camposFaltando = [];

        // 1. Validação
        for (const campo of camposObrigatorios) {
            const elemento = document.getElementById(campo.id);
            if (!elemento.value || elemento.value.trim() === "") {
                camposFaltando.push(campo.nome);
            }
        }

        if (camposFaltando.length > 0) {
            const listaCampos = camposFaltando.join('\n- ');
            alert(
                'ATENÇÃO: Não foi possível gerar o memorando. Os seguintes campos obrigatórios estão incompletos ou vazios:\n\n- ' + listaCampos
            );
            const primeiroCampoFaltando = document.getElementById(camposObrigatorios.find(c => camposFaltando.includes(c.nome)).id);
            if (primeiroCampoFaltando) {
                primeiroCampoFaltando.focus();
            }
            return;
        }

        // 2. Coleta e Inserção de Dados no Template
        const dados = {
            unidadeEmissora: document.getElementById('unidadeEmissora').value,
            exercicio: document.getElementById('exercicio').value,
            dataMemorando: document.getElementById('dataMemorando').value,
            setorAtendido: document.getElementById('setorAtendido').value,
            objetoContrato: document.getElementById('objetoContrato').value,
            nomeFiscal: document.getElementById('nomeFiscal').value,
            rgFiscal: document.getElementById('rgFiscal').value,
            cpfFiscal: document.getElementById('cpfFiscal').value,
            matriculaFiscal: document.getElementById('matriculaFiscal').value,
            lotacaoFiscal: document.getElementById('lotacaoFiscal').value,
            nomeSuplente: document.getElementById('nomeSuplente').value,
            rgSuplente: document.getElementById('rgSuplente').value,
            cpfSuplente: document.getElementById('cpfSuplente').value,
            matriculaSuplente: document.getElementById('matriculaSuplente').value,
            nomeDesignante: document.getElementById('nomeDesignante').value,
            cargoDesignante: document.getElementById('cargoDesignante').value,
        };

        const [unidadeLinha1, unidadeLinha2] = dividirUnidade(dados.unidadeEmissora);
        document.getElementById('out-unidadeEmissora1').textContent = unidadeLinha1;
        document.getElementById('out-unidadeEmissora2').textContent = unidadeLinha2;

        document.getElementById('out-exercicio').textContent = dados.exercicio;
        document.getElementById('out-setorAtendido').textContent = dados.setorAtendido;
        document.getElementById('out-objetoContrato').textContent = dados.objetoContrato;
        document.getElementById('out-dataExtenso').textContent = formatarData(dados.dataMemorando);

        document.getElementById('out-nomeFiscal').textContent = dados.nomeFiscal;
        document.getElementById('out-rgFiscal').textContent = dados.rgFiscal;
        document.getElementById('out-cpfFiscal').textContent = dados.cpfFiscal;
        document.getElementById('out-matriculaFiscal').textContent = dados.matriculaFiscal;
        document.getElementById('out-lotacaoFiscal').textContent = dados.lotacaoFiscal;
        document.getElementById('out-ciencia-fiscal').textContent = dados.nomeFiscal; 
        document.getElementById('out-assinatura-fiscal').textContent = dados.nomeFiscal; 

        document.getElementById('out-nomeSuplente').textContent = dados.nomeSuplente;
        document.getElementById('out-rgSuplente').textContent = dados.rgSuplente;
        document.getElementById('out-cpfSuplente').textContent = dados.cpfSuplente;
        document.getElementById('out-matriculaSuplente').textContent = dados.matriculaSuplente;
        document.getElementById('out-ciencia-suplente').textContent = dados.nomeSuplente; 
        document.getElementById('out-assinatura-suplente').textContent = dados.nomeSuplente; 
        
        document.getElementById('out-nomeDesignante').textContent = dados.nomeDesignante;
        document.getElementById('out-cargoDesignante').textContent = dados.cargoDesignante;
        
        // 3. Alternar a Visualização para o modo Memorando
        document.getElementById('formulario').style.display = 'none';
        document.getElementById('memorando-output').style.display = 'block';
    }

    // FUNÇÃO: Voltar e Editar
    function voltarParaEdicao() {
        document.getElementById('memorando-output').style.display = 'none';
        document.getElementById('formulario').style.display = 'block';
        aplicarEstiloPreenchido(); 
    }

    // INICIALIZAÇÃO: Monitoramento de campos para destaque
    document.addEventListener('DOMContentLoaded', () => {
        aplicarEstiloPreenchido(); 
        
        const campos = document.querySelectorAll('input, textarea, select');
        
        campos.forEach(campo => {
            campo.addEventListener('input', aplicarEstiloPreenchido);
            campo.addEventListener('change', aplicarEstiloPreenchido);
            campo.addEventListener('focus', aplicarEstiloPreenchido);
        });
    });
</script>

</body>
</html>
